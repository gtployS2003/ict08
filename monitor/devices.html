<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/ict8/assets/image/logo_หน่วย8.png" />
    <title>ระบบงานสารสนเทศ</title>

    <!-- app config (API_BASE, ENV, etc.) -->
    <script src="/ict8/backend/public/config.js.php"></script>

    <!-- include head -->
    <script src="/ict8/assets/js/include.js" defer></script>
    <script src="/ict8/assets/js/auth.js" defer></script>
    <script src="/ict8/assets/js/main.js" defer></script>

    <!-- device list -->
    <script type="module" src="/ict8/assets/js/devices-list.js" defer></script>

  </head>

  <body>
    <div id="header-device"></div>
    <div id="device-nav"></div>

    <main class="main">
      <section class="device-list">
        <div class="device-list-header">
          <!-- Row 1: title + add + search -->
          <div class="device-titlebar">
            <h1 class="device-list-title">รายการอุปกรณ์</h1>

            <button id="btn-device-add" class="add-device" type="button" title="เพิ่มอุปกรณ์">
              <i class="fa-solid fa-plus"></i> เพิ่มอุปกรณ์
            </button>

            
          </div>

          <!-- Row 2: filters -->
          <div class="device-filterbar">
            <div class="device-list-search">
              <input type="search" id="device-search" placeholder="ค้นหา" />
              <button id="device-search-clear" class="device-list-search-clear" type="button" title="ล้าง">
                x
              </button>
            </div>

            <select id="device-filter-province" class="device-filter-select" title="กรองจังหวัด">
              <option value="">ทุกจังหวัด</option>
            </select>

            <select id="device-filter-org" class="device-filter-select" title="กรองหน่วยงาน">
              <option value="">ทุกหน่วยงาน</option>
            </select>

            <select id="device-filter-main-type" class="device-filter-select" title="กรองประเภทหลัก">
              <option value="">ทุกประเภทหลัก</option>
            </select>

            <select id="device-filter-type" class="device-filter-select" title="กรองประเภทอุปกรณ์">
              <option value="">ทุกประเภทอุปกรณ์</option>
            </select>

            <select id="device-limit" class="device-limit-select" title="จำนวนต่อหน้า">
              <option value="20">20/หน้า</option>
              <option value="50" selected>50/หน้า</option>
              <option value="100">100/หน้า</option>
            </select>

            <button id="device-refresh" class="btn btn-ghost" type="button" title="รีเฟรช">
              <i class="fa-solid fa-rotate"></i>
            </button>
          </div>
        </div>

        <div class="device-list-table-container">
          <table class="device-list-table">
            <thead>
              <tr>
                <th style="width: 70px;">ID</th>
                <th>ชื่ออุปกรณ์</th>
                <th>ประเภทหลัก</th>
                <th>ประเภทอุปกรณ์</th>
                <th style="width: 140px;">ip</th>
                <th>หน่วยงาน</th>
                <th style="width: 140px;">จังหวัด</th>
                <th style="width: 110px;">สถานะ</th>
                <th style="width: 140px;">จัดการ</th>
              </tr>
            </thead>

            <tbody id="device-tbody">
              <!-- JS render -->
            </tbody>
          </table>
        </div>

        <!-- meta (below table): total left, pagination centered -->
        <div class="device-meta device-meta-bottom">
          <div id="device-total" class="device-total">-</div>
          <div id="device-pagination" class="device-pagination"></div>
          <div class="device-meta-spacer" aria-hidden="true"></div>
        </div>
      </section>

      <!-- MODAL: Add/Edit Device -->
      <div id="device-modal" class="modal" hidden>
        <div class="modal__overlay" data-close="1"></div>

        <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="device-modal-title">
          <div class="modal__header">
            <h3 id="device-modal-title">เพิ่มอุปกรณ์</h3>
            <button id="device-modal-close" class="modal__close" type="button" title="ปิด">×</button>
          </div>

          <div class="modal__body">
            <div id="device-form-error" class="form-error" hidden></div>

            <form id="device-form">
              <!-- hidden id for edit -->
              <input type="hidden" id="device-id" />

              <div class="form-grid">
                <!-- 1) device_name (auto) -->
                <div class="form-field full">
                  <label for="device-name">ชื่ออุปกรณ์ (อัตโนมัติ)</label>
                  <input id="device-name" type="text" autocomplete="off" readonly />
                </div>

                <!-- 2) main_type_of_device -->
                <div class="form-field">
                  <label for="device-main-type">ประเภทหลักของอุปกรณ์ *</label>
                  <select id="device-main-type" required>
                    <option value="">เลือกประเภทหลัก</option>
                  </select>
                </div>

                <!-- 3) type_of_device -->
                <div class="form-field">
                  <label for="device-type">ประเภทอุปกรณ์ *</label>
                  <select id="device-type" required>
                    <option value="">เลือกประเภทอุปกรณ์</option>
                  </select>
                </div>

                <!-- 4) ip -->
                <div class="form-field">
                  <label for="device-ip">ip (ถ้ามี)</label>
                  <input id="device-ip" type="text" placeholder="เช่น 192.168.1.10" autocomplete="off" />
                </div>

                <!-- 5) contact_info_id (หน่วยงาน) -->
                <div class="form-field">
                  <label for="device-org">หน่วยงาน *</label>
                  <select id="device-org" required>
                    <option value="">เลือกหน่วยงาน</option>
                  </select>
                </div>

                <!-- 6) detail -->
                <div class="form-field full">
                  <label for="device-detail">รายละเอียด</label>
                  <textarea id="device-detail" rows="3" placeholder="รายละเอียดเพิ่มเติม..."></textarea>
                </div>
              </div>

              <div class="table-footer" style="margin-top: 14px;">
                <div></div>
                <div class="row-actions" style="justify-content: flex-end;">
                  <button id="device-submit" class="btn btn-primary" type="submit">บันทึก</button>
                  <button id="device-cancel" class="btn btn-ghost" type="button" data-close="1">ยกเลิก</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- END MODAL -->
    </main>

    <div id="footer-index"></div>
  </body>
</html>
